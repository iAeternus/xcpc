# äºŒåˆ†

äºŒåˆ†çš„ä¸¤ç§å½¢å¼ï¼š

1ã€èŒƒå›´ç¼©å°æ—¶ï¼Œr = midï¼Œl = mid + 1ï¼Œå–ä¸­é—´å€¼æ—¶ï¼Œmid = (l + r) >> 1.

2ã€èŒƒå›´ç¼©å°æ—¶ï¼Œl = midï¼Œr = mid - 1ï¼Œå–ä¸­é—´å€¼æ—¶ï¼Œmid = (l + r + 1) >> 1;

 

æ€»è€Œè¨€ä¹‹ï¼Œæ­£ç¡®å†™å‡ºäºŒåˆ†çš„æµç¨‹æ˜¯ï¼š

1ã€é€šè¿‡åˆ†æå…·ä½“é—®é¢˜ï¼Œç¡®å®šå·¦å³åŠæ®µå“ªä¸€ä¸ªæ˜¯å¯è¡ŒåŒºé—´ï¼Œä»¥åŠ mid å½’å±å“ªä¸€åŠæ®µã€‚

2ã€æ ¹æ®åˆ†æç»“æœï¼Œé€‰æ‹©â€œr = mid, l = mid + 1, mid = (l + r) >> 1â€ å’Œâ€œl = mid, r= mid - 1, mid = (l + r + 1) >> 1â€ä¸¤ä¸ªé…å¥—å½¢å¼ä¹‹ä¸€ã€‚

3ã€äºŒåˆ†çš„ç»ˆæ­¢æ¡ä»¶æ˜¯ l == rï¼Œè¯¥å€¼å°±æ˜¯ç­”æ¡ˆæ‰€åœ¨ä½ç½®ã€‚

# çº¿æ®µæ ‘

<img src="C:\Users\ZA\Desktop\9FX}HI8`1~XJA8C6_V8%K8R.png" alt="./" style="zoom:25%;" />

çº¿æ®µæ ‘æ¯å±‚ç»“ç‚¹åªä¼šé€‰æ‹©ä¸¤æ¬¡ï¼Œç”±äºåŒºé—´æ˜¯è¿ç»­çš„ï¼Œå¦‚æœé€‰æ‹©äº†ä¸‰æ¬¡ï¼Œé‚£ä¹ˆä¸­é—´çš„ç»“ç‚¹ä¼šå’Œä»–ä¸€ä¸ªç›¸é‚»çš„ç»“ç‚¹å˜æˆçˆ¶äº²çš„ç»“ç‚¹ï¼Œä»è€Œå˜æˆä¸Šä¸€å±‚ç»“ç‚¹äº†ã€‚

çº¿æ®µæ ‘ä¸­ç©ºé—´å¼€4å€

å¯¹äºé•¿ä¸º nçš„åºåˆ—ï¼Œæ˜¾ç„¶ä»¥å…¶æ„å»ºçš„çº¿æ®µæ ‘æœ‰ nä¸ªå¶å­èŠ‚ç‚¹ï¼Œæ­¤æ—¶çº¿æ®µæ ‘é«˜åº¦ä¸º$$k = [\log_2n]+1$$

è‡³å¤šæœ‰$$2^kâˆ’1$$ ä¸ªç»“ç‚¹ï¼Œå³æœ‰$$2^{[\log_2n]+1}-1$$ä¸ªç»“ç‚¹ï¼Œå½“$$log_2n$$ä¸ºæ•´æ•°æ—¶ï¼Œç»“ç‚¹æ•°ä¸º$$2n-1$$ï¼Œå½“$$log_2n$$ä¸ä¸ºæ•´æ•°æ—¶ï¼Œç»“ç‚¹æ•°ä¸º$$2^{[\log_2n]+2}-1$$ï¼Œå³$$4n-1$$ã€‚

çº¿æ®µæ ‘æ ‡å· å·¦å„¿å­ä¸ºçˆ¶äº²å·ç ä¹˜2ï¼Œå³å„¿å­ä¸ºçˆ¶äº²å·ç ä¹˜2åŠ 1

ç¬¬ä¸€å±‚ä¸º    1 

ç¬¬äºŒå±‚ä¸º   2 3 

ç¬¬ä¸‰å±‚ä¸º4 5 6 7

åŒºé—´ä¿®æ”¹ä¸­ä¸ºä»€ä¹ˆè¦åŠ v[i]

v[i]è¡¨ç¤ºçº¿æ®µæ ‘é€’å½’çš„æœ€ç»ˆåŒºé—´æ¯ä¸ªæ•°éƒ½è¦åŠ kï¼Œå¦‚æœè¿˜èƒ½å¾€ä¸‹é€’å½’ï¼Œè¿™æ ·ä¼šæµªè´¹æ—¶é—´ï¼Œäºæ˜¯æˆ‘ç”¨ä¸€ä¸ªv[i]è¡¨ç¤ºä¸‹é¢ç»“ç‚¹éƒ½è¦åŠ v[i]ï¼›

å› æ­¤f[k]æ¯æ¬¡éƒ½åŠ äº†å…¨éƒ¨ä¿®æ”¹å€¼ï¼Œä½†æ˜¯åœ¨æœ€ç»ˆåŒºé—´æ˜¯ä¸åŠ çš„ï¼Œè¿™æ—¶å€™è¦ç”¨åˆ°v[i]ã€‚

v[i]ä¸ºå½“å‰ç»“ç‚¹å…¨éƒ¨åŠ äº†kï¼Œå¹¶ä¸”ä¸‹é¢ç»“ç‚¹ä¹ŸåŠ kï¼Œf[i]å½“å‰ç»“ç‚¹kæˆ‘å·²ç»å…¨éƒ¨åŠ ä¸Šå»äº†ï¼Œä½†æ˜¯ä¸‹é¢ç»“ç‚¹åŠ æ²¡åŠ ä¸çŸ¥é“ã€‚v[i]æ ‡è®°ä¸‹é¢æ‰€æœ‰ç»“ç‚¹éƒ½è¦åŠ kï¼Œç”¨æ ‡è®°ä»£æ›¿äº†é€’å½’ã€‚

å‡½æ•°ä¸­kä¸ºå½“å‰æŸ¥è¯¢ç»“ç‚¹å·ï¼Œä¸€å¼€å§‹ä»é¡¶ç‚¹å¼€å§‹æŸ¥è¯¢ï¼Œé»˜è®¤ä¸º1ï¼Œlrä¸ºç»“ç‚¹è¡¨ç¤ºçš„åŒºé—´é»˜è®¤ä¸ºï¼ˆ1ï¼Œn),

æ ‡è®°ä¸‹æ”¾

ç”±äºv[k]è¡¨ç¤ºå½“å‰æ ‘çš„ç»“ç‚¹ä»¥åŠå­å­™ç»“ç‚¹éƒ½è¦åŠ v[k]ï¼Œé‚£ä¹ˆå¯ä»¥æŠŠå½“å‰ç»“ç‚¹çš„v[k]åŠ ä¸Šå»ï¼Œç„¶åå½“å‰ç»“ç‚¹çš„v[k]æ¸…é›¶ï¼Œå­ç»“ç‚¹çš„v[k]åŠ ä¸Šçˆ¶ç»“ç‚¹çš„v[k]ã€‚

##### å»ºæ ‘

```c++
void bulidtree(int k,int l,int r)//æ ‡å·ä¸º1çš„ç‚¹çš„åŒºé—´å¼€å§‹å»ºæ ‘bulidtree(1,1,n)
{
    v[k] = 0;
	if(l == r)
	{
		f[k] = a[l];//ä¸¤ç«¯å’Œç›¸åŒåŒºé—´å’Œç­‰äºæœ¬èº«
		return;
	}
	int m = (l + r)>>1;
	bulidtree(k + k, l, m);
	bulidtree(k + k + 1, m + 1, r);
	f[k] = f[k + k + 1] + f[k + k];
}
```

##### å•ç‚¹ä¿®æ”¹(æŸä¸ªæ•°å€¼æ”¹å˜)

```cpp
void add(int k,int l,int r,int x,int y)//kç»“ç‚¹å¯¹åº”çš„åŒºé—´ä¸Šçš„ä¸‹æ ‡ä¸ºxçš„æ•°ä¸Šï¼Œxè‚¯å®šåœ¨lrä¹‹é—´
{
	f[k]+=y;//åŒ…å«ä¸‹æ ‡çš„xçš„åŒºé—´ä¸­çš„ç»“ç‚¹éƒ½è¦åŠ y;
	if(l == r)
		return;
	int m = (l+r)>>1;
	if(x <= m)
	{
		add(k + k,l,m,x,y);
	}
	else
	{
		add(k + k + 1,m + 1,r,x,y);
	}
	
}
```

##### å•ç‚¹æŸ¥è¯¢(æŸ¥è¯¢æŸä¸ªæ•°å€¼)(å¯ä»¥å¥—ç”¨å¤šç‚¹)

```c++
long long chaxun(int k,int l,int r,int x,int p)
{
	p += v[k];
	if(l == r)
	{
		return f[k]+p;
	}
	int m = (l + r)>>1;
	if(x <= m)
	{
		return chaxun(k + k, l, m, x, p);
	}
	else
	{
		return chaxun(k + k + 1, m + 1, r, x, p);
	}
}
```

##### åŒºé—´ä¿®æ”¹(åŒºé—´é‡Œçš„æ•°å€¼å‘ç”Ÿæ”¹å˜)

```c++
void insert(int k,int l,int r,int x,int y,long long z)//l-råŒºé—´é‡Œçš„xyåŒºé—´åŠ ä¸Šz,kä¸ºå½“å‰æŸ¥è¯¢åŒºé—´
{
	if(l == x&&r == y)
	{
		v[k] += z;
		return;
	}
	f[k] += (y - x + 1) * z;//åŒºé—´é•¿åº¦æ¯ä¸ªåŠ z
	int m = (l + r)>>1;
	if(y <= m)
	{
		insert(k + k, l, m, x, y, z);
	}
	else
	{
		if(x > m)
		{
			insert(k + k + 1, m + 1, r, x, y, z);
		}
		else
		{
			insert(k + k, l, m, x, m, z);
			insert(k + k + 1, m + 1, r, m + 1,y,z);
		}
	}
}
```

æ ‡è®°ä¸‹ä¼ 

```c++
void insert(int k,int l,int r,int x,int y,long long z)//l-råŒºé—´é‡Œçš„xyåŒºé—´åŠ ä¸Šz,kä¸ºå½“å‰æŸ¥è¯¢åŒºé—´
{
	if(l == x && r == y)
	{
		v[k] += z;
		return;
	}
	if(v[k])
	{
		v[k + k] += v[k];
		v[k + k + 1] += v[k];
		v[k] = 0;
	}
	int m = (l + r)>>1;
	if(y <= m)
	{
		insert(k + k, l, m, x, y, z);
	}
	else
	{
		if(x > m)
		{
			insert(k + k + 1, m + 1, r, x, y, z);
		}
		else
		{
			insert(k + k, l, m, x, m, z);
			insert(k + k + 1, m + 1, r, m + 1, y, z);
		}
	}
	//æ ‡è®°å›æ”¶ 
	f[k] = f[k + k] + v[k + k] * (m - l + 1) + f[k + k + 1] + v[k + k + 1] * (r - m);
}
```



##### åŒºé—´æŸ¥è¯¢

1.ä¸å¸¦v[i]

```c++
long long calc(int k,int l,int r,int s,int t)//kç»“ç‚¹ä»£è¡¨lrçš„åŒºé—´ï¼Œæ±‚stçš„å’Œ
{
	if(l==s && r==t)
	{
		return f[k];
	}
	int m = (l + r)>>1;
	if(t <= m)
	{
		return calc(k + k, l, m, s, t);
	}
	else
	{
		if(s > m)
			return calc(k + k + 1, m + 1, r, s, t);
		else
			return calc(k + k, l, m, s, m) + calc(k + k + 1, m + 1, r, m + 1, t);	
	}
}
```

2.å¸¦v[i]

```c++
long long  calc(int k,int l,int r,int x,int y,long long p)//kç»“ç‚¹ä»£è¡¨lrçš„åŒºé—´ï¼Œæ±‚stçš„å’Œ
{
	p += v[k];
	if(l == x&&r == y)
	{
		return p * (r - l + 1) + f[k];
	}
	int m = (l + r)>>1;
	if(y <= m)
	{
		return calc(k + k, l, m, x, y, p);
	}
	else
	{
		if(x > m)
			return calc(k + k + 1, m + 1, r, x, y, p);
		else
			return calc(k + k, l, m, x, m, p) + calc_1(k + k + 1, m + 1, r, m+1, y, p);	
	}
}
```

3.æ ‡è®°ä¸‹ä¼ 

```c++
long long calc(int k,int l,int r,int s,int t)//kç»“ç‚¹ä»£è¡¨lrçš„åŒºé—´ï¼Œæ±‚stçš„å’Œ
{
	if(l==s&&r==t)
	{
		return f[k] + v[k] * (r - l + 1);
	}
	if(v[k])//æ ‡è®°ä¸‹ç§»
	{
		v[k + k] += v[k];
		v[k + k + 1] += v[k];
		v[k] = 0;
	}
	int m = (l + r)>>1;
	long long res = 0;//è®°å½•æŸ¥è¯¢ç»“æœ,ä¸èƒ½ç›´æ¥return,å› ä¸ºæ²¡æœ‰ä¿®æ”¹fçš„å€¼
	if(t <= m)
	{
		res = calc(k + k,l,m,s,t);
	}
	else
	{
		if(s > m) 
			res = calc(k + k + 1, m + 1, r, s, t);
		else
			res = calc(k + k, l, m, s, m) + calc(k + k + 1, m + 1, r, m+1, t);	
	}
	f[k] = f[k + k] + v[k + k] * (m - l + 1) + f[k + k + 1] + v[k + k + 1] * (r - m);
	return res;//fä¿®æ”¹å®Œåreturnç»“æœ
}
```

åœ¨insertä¸­å·²ç»æ ‡è®°ä¸‹ä¼ äº†ï¼Œåœ¨calcä¸­ä¹Ÿéœ€è¦ä¸‹ä¼ ï¼Œå› ä¸ºinsertä¸­çš„æœ€åä¸€ç»“ç‚¹å¹¶æ²¡æœ‰æ‰§è¡Œä¸‹ä¼ æ“ä½œã€‚

æ ‡è®°ä¸‹ç§»ä¸€èˆ¬è‡ªå·±å†™å‡½æ•°ã€‚

# è´Ÿè¿›åˆ¶

ä¾‹å¦‚-15 çš„-2è¿›åˆ¶ä¸º110001//8+4+2+1//1111

è§£ç­”æ­¥éª¤ï¼š

-15 /-2 = 8â€¦â€¦1

8 /-2 = -4â€¦â€¦0

-4/-2=2â€¦â€¦0

2/-2=-1â€¦â€¦0

-1/-2=1â€¦â€¦1

1/-2=0â€¦â€¦1

å¯¹äºç¬¬ä¸€é¡¹-15/-2ä¸ºä»€ä¹ˆä¸èƒ½ä¸º7â€¦â€¦-1ï¼Œ**å› ä¸ºä½™æ•°ä¸èƒ½ä¸ºè´Ÿæ•°ï¼Œä½†æ˜¯åœ¨è®¡ç®—æœºä¸­ç»“æœæ˜¯è¿™æ ·çš„ï¼š-15%-2 = -1,-15/-2 = 7**ï¼Œä¸æ»¡è¶³è¿ç®—è§„åˆ™ã€‚æˆ‘ä»¬åªéœ€è¦å°†å•†+1ï¼Œä½™æ•°-é™¤æ•°å³å¯ï¼Œå› ä¸ºä½™æ•°ï¼ˆç»å¯¹å€¼ï¼‰ä¸€å®šå°äºé™¤æ•°ï¼Œæ‰€ä»¥è¿™æ ·å°±å¯ä»¥å°†ä½™æ•°è£…æ¢ä¸ºæ­£æ•°ã€‚

å•†\*é™¤æ•°+ä½™æ•°=è¢«é™¤æ•°

å•†\*é™¤æ•°+é™¤æ•°+ä½™æ•°-é™¤æ•°=è¢«é™¤æ•°

(å•†+1ï¼‰\*é™¤æ•°+ï¼ˆä½™æ•°-é™¤æ•°ï¼‰=è¢«é™¤æ•°

7*(-2)-1 = -15

(7+1)*(-2)+1 = -15

å¯¹äºåŸæœ¬ä½™æ•°æ˜¯æ­£æ•°çš„ä¸èƒ½ä½¿ç”¨ï¼Œæ­¤å¼å­ä¼šæ”¹å˜å•†çš„ç»“æœå’Œä½™æ•°ç»“æœï¼Œå•†ç»“æœä¸ºå•†+1ï¼Œ

ä½™æ•°ç»“æœä¸ºä½™æ•°-é™¤æ•°

[P1017 [NOIP2000 æé«˜ç»„\] è¿›åˆ¶è½¬æ¢ - æ´›è°· | è®¡ç®—æœºç§‘å­¦æ•™è‚²æ–°ç”Ÿæ€ (luogu.com.cn)](https://www.luogu.com.cn/problem/P1017)

```
è¾“å…¥æ ¼å¼

ç¬¬ä¸€ä¸ªæ˜¯åè¿›åˆ¶æ•° nã€‚ç¬¬äºŒä¸ªæ˜¯è´Ÿè¿›åˆ¶æ•°çš„åŸºæ•° ğ‘…ã€‚

è¾“å‡ºæ ¼å¼

è¾“å‡ºæ­¤è´Ÿè¿›åˆ¶æ•°åŠå…¶åŸºæ•°ï¼Œè‹¥æ­¤åŸºæ•°è¶…è¿‡ 10ï¼Œåˆ™å‚ç…§ 16 è¿›åˆ¶çš„æ–¹å¼å¤„ç†ã€‚
```

```c++
#include <bits/stdc++.h>
using namespace  std;
char a[]= {'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T'
			,'U','V','W','X','Y','Z'};
int main ()
{
	int n;
	cin >>n;
	int chushu,shang,yushu;
	int r;
	cin >> r;
	chushu = n;
	shang = 1;
	char b[100000];
	int i = 0;
	while(shang !=0)
	{
		
		shang = chushu / r;
		yushu = chushu % r;
		if(yushu < 0 )//ä½™æ•°å°äº0ï¼Œæ”¹å˜å•†å’Œä½™æ•°çš„å€¼ã€‚
		{
			shang++;
			yushu=yushu-r;
		}
		if(yushu >= 10)
			b[i] = a[yushu-10];
		else
			b[i] = yushu+'0';
		i++;
		chushu = shang;
	}
	cout<<n<<"=";
	for(int j = i - 1;j >=0;j--)
	{
		
		cout<<b[j];
	}
	cout<<"(base"<<r<<")";
	return 0;
}

```

# é«˜ç²¾åº¦

### é«˜ç²¾åº¦åŠ æ³•

A+B

```c++
int g = 0;//è¿›ä½
for(i= 0;i < b.size();i++)
{
	a[i] = a[i]+b[i]+g;
	g = a[i] / 10;
	a[i] = a[i] % 10;
}
if(a[l + 1] > 0)//è€ƒè™‘ä»æœ€é«˜ä½è¿›ä½åˆ°æœ€é«˜ä½çš„ä¸‹ä¸€ä½ 
{
	l++;//é•¿åº¦++ 
}
```



### é«˜ç²¾åº¦å‡æ³•

A-B

A2 A1 A0

â€‹     B1 B0

\--------------

â€‹      C1 C0

(1)å½“Ai-Bi-t>=0 Ciä¸ºæœ¬èº«

(2)å½“Ai-Bi-t<0 Ciä¸ºæœ¬èº«+10



```c++
for(i= 0;i < b.size();i++)
{
	a[i] = a[i]-b[i]-g+10;
	g = a[i] / 10;
	a[i] = a[i] % 10;
}
```



### é«˜ç²¾åº¦ä¹˜æ³•

```

```

### é«˜ç²¾åº¦é™¤æ³•

```

```

# å­—ç¬¦ä¸²

### KMP

```cpp
/**
 * è·å–nextæ•°ç»„
 * @par t æ¨¡å¼ä¸²
 * @return nextæ•°ç»„
 */
std::vector<int> get_next(const std::string& t) {
    int m = t.size();
    std::vector<int> next(m, 0);
    int j = 0;  // jä¸ºæ¨¡å¼ä¸²ä¸­å·²åŒ¹é…çš„å‰ç¼€é•¿åº¦
    for (int i = 1; i < m; ++i) {
        while (j > 0 && t[i] != t[j]) {
            j = next[j - 1];
        }
        if (t[i] == t[j]) {
            ++j;
        }
        next[i] = j;
    }
    return next;
}

/**
 * tmpç®—æ³•åŒ¹é…æ¨¡å¼ä¸²
 * @par s æ–‡æœ¬ä¸²
 * @par t æ¨¡å¼ä¸²
 * @return tåœ¨sä¸­å‡ºç°çš„æ‰€æœ‰ä½ç½®ï¼ˆèµ·å§‹ç´¢å¼•ï¼‰ï¼Œè‹¥ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›ç©ºåˆ—è¡¨
 */
std::vector<int> kmp(const std::string& s, const std::string& t) {
    std::vector<int> res;
    std::vector<int> next = get_next(t);
    int n = s.size(), m = t.size();
    int j = 0;  // jä¸ºæ¨¡å¼ä¸²ä¸­å·²åŒ¹é…çš„å‰ç¼€é•¿åº¦
    for (int i = 0; i < n; ++i) {
        while (j > 0 && s[i] != t[j]) {
            j = next[j - 1];
        }
        if (s[i] == t[j]) {
            ++j;
        }
        // æ¨¡å¼ä¸²åŒ¹é…å®Œ
        if (j == m) {
            res.push_back(i - m + 1);
            j = next[j - 1];
        }
    }
    return res;
}
```



### å­—å…¸æ ‘

```cpp
const int N = 8e5 + 3;

struct node {
    int cnt; // è¿™ä¸ªå‰ç¼€å‡ºç°çš„æ¬¡æ•°
    int son[26]; // 26ä¸ªå­—æ¯ï¼Œ26ä¸ªå„¿å­
    bool repeat; // è¿™ä¸ªå‰ç¼€æ˜¯å¦é‡å¤
    node() {
        cnt = 0;
        memset(son, false, sizeof son);
        repeat = false;
    }
} trie[N];

int num = 0;

/**
 * æ’å…¥å­—ç¬¦ä¸²
 * @par str å¸¦æ’å…¥çš„å­—ç¬¦ä¸²
 */
void insert(char* s) {
    int v, len = strlen(s);
    int u = 0;
    for (int i = 0; i < len; i++) {
        v = s[i] - 'a';
        if (!trie[u].son[v]) {
            trie[u].son[v] = ++num;
        }
        u = trie[u].son[v];
    }
    trie[u].repeat = 1;
}

/**
 * æŸ¥è¯¢å­—ç¬¦ä¸²
 * @par å¾…æŸ¥è¯¢çš„å­—ç¬¦ä¸²
 * @return 1=å­˜åœ¨ 2=é‡å¤ 3=ä¸å­˜åœ¨
 */
int find(char* s) {
    int v, u = 0, len = strlen(s);
    for (int i = 0; i < len; i++) {
        v = s[i] - 'a';
        if (!trie[u].son[v]) {
            return 3;
        }
        u = trie[u].son[v];
    }
    if (!trie[u].repeat) {
        return 3;
    }
    if (!trie[u].cnt) {
        trie[u].cnt++;
        return 1;
    }
    return 2;
}
```

### åç¼€æ•°ç»„

æ±‚è§£å•æ¨¡åŒ¹é…é—®é¢˜

#### å€å¢æ³•è®¡ç®—åç¼€æ•°ç»„

```cpp
const int N = 2e5 + 5; // å­—ç¬¦ä¸²çš„é•¿åº¦

int sa[N], rk[N], tmp[N + 1];
int k, n;

/**
 * ç»„åˆæ•°æœ‰ä¸¤éƒ¨åˆ†
 * é«˜ä½æ˜¯rk[i]ï¼Œä½ä½æ˜¯rk[i + k]
 */
auto comp_sa = [&](int i, int j) -> bool {
    if(rk[i] != rk[j]) {
        return rk[i] < rk[j];
    } else {
        int ri = i + k <= n ? rk[i + k] : -1;
        int rj = j + k <= n ? rk[j + k] : -1;
        return ri < rj;
    }
};

/**
 * è®¡ç®—sçš„åç¼€æ•°ç»„
 * O(n log n)
 * @par s æ–‡æœ¬ä¸²
 * @par sa åç¼€æ•°ç»„ï¼Œéœ€è¦å¼€è¶³å¤Ÿçš„æ ˆç©ºé—´
 */
void calc_sa(const std::string& s, int* sa) {
    n = s.length();
    for(int i = 0; i <= n; ++i) {
        rk[i] = s[i];
        sa[i] = i;
    }
    for(k = 1; k <= n; k <<= 1) {
        std::sort(sa, sa + n, comp_sa);
        tmp[sa[0]] = 0;
        for(int i = 0; i < n; ++i) {
            tmp[sa[i + 1]] = tmp[sa[i]] + (comp_sa(sa[i], sa[i + 1]) ? 1 : 0);
        }
        for(int i = 0; i < n; ++i) {
            rk[i] = tmp[i];
        }
    }
}
```

#### è®¡æ•°æ’åºè®¡ç®—åç¼€æ•°ç»„

```cpp

```

#### å­—ç¬¦ä¸²åŒ¹é…

```cpp
/**
 * åœ¨sä¸­æŸ¥æ‰¾t
 * æ—¶é—´å¤æ‚åº¦ O(m log n)
 * @par s æ–‡æœ¬ä¸²
 * @par t æ¨¡å¼ä¸²
 * @par sa åç¼€æ•°ç»„
 * @return è¿”å›tåœ¨sä¸­çš„ä½ç½® 
 */
int find(const std::string& s, const std::string& t, int* sa) {
    int i = 0, j = s.length();
    while(j - i > 1) {
        int k = i + ((j - i) >> 1);
        if(s.compare(sa[k], t.length(), t) < 0) {
            i = k;
        } else {
            j = k;
        }
    }

    if(s.compare(sa[j], t.length(), t) == 0) {
        return sa[j];
    }
    if(s.compare(sa[i], t.length(), t) == 0) {
        return sa[i];
    }
    return -1; // æ²¡æ‰¾åˆ°
}
```



# å›¾è®º

## å›¾è®ºåŸºæœ¬ç®—æ³•

### é“¾å¼å‰å‘æ˜Ÿå»ºå›¾

```cpp
const int N = 1e5 + 3;

struct Edge {
    int to, next, weight;
} edge[N << 1];

int head[N], cnt;

/**
 * åˆå§‹åŒ–å›¾
 */
void init() {
    for(auto& h : head) {
        h = -1;
    }
    for(auto& e : edge) {
        e.next = -1;
    }
    cnt = 0;
}

/**
 * æ·»åŠ è¾¹
 * @par from èµ·ç‚¹
 * @par to ç»ˆç‚¹
 * @par weight è¾¹æƒ
 */
void add_edge(int from, int to, int weight) {
    edge[cnt].to = to;
    edge[cnt].weight = weight;
    edge[cnt].next = head[from];
    head[from] = cnt++;
}

/**
 * éå†curçš„é‚»æ¥ç»“ç‚¹
 * @par cur å½“å‰èŠ‚ç‚¹
 * @par func å¯¹é‚»æ¥ç»“ç‚¹çš„æ“ä½œé€»è¾‘ï¼Œå‚æ•°ä¸ºé‚»æ¥èŠ‚ç‚¹çš„ç´¢å¼•
 * @brief å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç éå†é‚»æ¥èŠ‚ç‚¹
 *      for_each(cur, [&](int i) {
 *          int neighbor = edge[i].to;
 *          int weight = edge[i].weight;
 *          ...
 *      })
 */
void for_each(int cur, const std::function<void(int)>& func) {
    for(int i = head[cur]; ~i; i = edge[i].next) {
        func(i);
    }
}
```

### dfs

```cpp
bool vis[N];

static void init_vis() {
    memset(vis, 0, sizeof vis);
}

static void dfs_algorithm(int u, const std::function<void(int)>& func) {
    func(u);
    vis[u] = true;
    for_each(u, [&](int i) {
        int to = edge[i].to;
        if (!vis[to]) {
            dfs_algorithm(to, func);
        }
    });
}

void dfs(int u, const std::function<void(int)>& func) {
    init_vis();
    dfs_algorithm(u, func);
}
```

### bfs

```cpp
void bfs(int u, const std::function<void(int)>& func) {
    init_vis();
    std::queue<int> q;
    vis[u] = true;
    q.push(u);
    while (!q.empty()) {
        int k = q.front();
        q.pop();
        func(k);
        for_each(k, [&](int i) {
            int to = edge[i].to;
            if (!vis[to]) {
                q.push(to);
                vis[to] = true;
            }
        });
    }
}
```

### SPFA

```cpp
/**
 * SPFAç®—æ³•æ±‚æœ€çŸ­è·¯å¾„
 * @par s èµ·ç‚¹
 * @par t ç»ˆç‚¹
 * @return æœ€çŸ­è·¯å¾„æƒé‡
 */
int SPFA(int s, int t) {
    int dist[N];
    std::queue<int> q;

    init_vis();
    std::fill(dist, dist + N, INF);

    q.push(s);
    vis[s] = true;
    dist[s] = 0;

    while (!q.empty()) {
        int cur = q.front();
        q.pop();
        vis[cur] = false;

        for_each(cur, [&](int i) {
            int to = edge[i].to;
            int w = edge[i].w;
            if (dist[to] > dist[cur] + w) {
                dist[to] = dist[cur] + w;
                if (!vis[to]) {
                    q.push(to);
                    vis[to] = true;
                }
            }
        });
    }
    return dist[t];
}
```

### SPFA SLFä¼˜åŒ–

```cpp
int SPFA_SLF(int s, int t) {
    int dist[N];
    std::deque<int> dq;

    init_vis();
    std::fill(dist, dist + N, INF);

    dq.push_back(s);
    vis[s] = true;
    dist[s] = 0;

    while (!dq.empty()) {
        int cur = dq.front();
        dq.pop_front();
        vis[cur] = false;

        for_each(cur, [&](int i) {
            int to = edge[i].to;
            int w = edge[i].w;
            if (dist[to] > dist[cur] + w) {
                dist[to] = dist[cur] + w;
                if (!vis[to]) {
                    vis[to] = true;
                    if (dq.size() && dist[to] >= dist[dq.front()]) {
                        dq.push_back(to);
                    } else {
                        dq.push_front(to);
                    }
                }
            }
        });
    }

    return dist[t];
}
```

## åŸºç¯æ ‘

åŸºç¯æ ‘ä¸­å¯»æ‰¾æœ€é•¿é“¾çŠ¶é‡‡ç”¨dfs

ä¾‹å¦‚2->3->4->3

æ­¤æ—¶ä¸€æ¡è·¯å¾„2343ä¸ºæœ€é•¿è·¯å¾„ï¼Œä¹‹ådir[3]dir[4]ä¸º1ä¸ä¼šæœç´¢ï¼Œå› ä¸ºä»–ä»¬ä¸€å®šæ²¡æœ‰dir[2]æœ€é•¿ã€‚

é‚£ä¹ˆå¦‚æœä»dir[3]å¼€å§‹ï¼Œdir[4]ä¹Ÿä¸ä¼šæœç´¢äº†ã€‚å› æ­¤2æ˜¯è¿›å…¥é“¾çš„æ–¹å‘ï¼Œä¸€æ—¦æœ‰1æ¡ç»„æˆçš„ç¯ï¼Œç¯å†…çš„æ•°éƒ½ä¸ç”¨æœç´¢äº†ã€‚

```cpp
int a[N];
int dir[N],s[N];
void dfs(int x,int sum)
{
	if(s[x] = 1)//è·¯å¾„é‡å¤
	{
		ans = max(ans, sum);
		return;
	}
	dir[x] = 1;//å‰ªæï¼Œæ ‡è®°æ­¤ç‚¹å·²ç»æœç´¢è¿‡äº†
	s[x] = 1;//æ ‡è®°æ­¤ç‚¹åœ¨çº¿è·¯ä¸Š
	dfs(s[x],sum+1)
	s[x] = 0;//æœç´¢å®Œæ¯•è·¯å¾„æ ‡è®°è¿˜åŸ
}
int main()
{
	int n,i;
	cin<<n;
	for(i = 1;i<= n;i++)
	{
		int t;
		cin>>t;
		a[i] = t;
	}
	for(i = 1;i <= n;i++)
	{
		while(!dir[x])
		{
			dfs(i,0)//ä»ç¬¬ä¸€ä¸ªç‚¹å¼€å§‹æœç´¢
		}
	}
}
```

## æ ‘é“¾å‰–åˆ†æ±‚LCA

```cpp
class HLD {
public:
    HLD(int n) {
        this->n = n;
        matrix.resize(n + 1);
        size.resize(n + 1);
        depth.resize(n + 1);
        top.resize(n + 1);
        son.resize(n + 1);
        parent.resize(n + 1);
    }

    /**
     * æ·»åŠ åŒå‘è¾¹
     * @par from èµ·ç‚¹
     * @par to ç»ˆç‚¹
     */
    void add_edge(int from, int to) {
        matrix[from].push_back(to);
        matrix[to].push_back(from);
    }

    /**
     * éå†curçš„é‚»æ¥ç»“ç‚¹
     * @par cur å½“å‰èŠ‚ç‚¹
     * @par func å¯¹é‚»æ¥ç»“ç‚¹æ‰§è¡Œçš„é€»è¾‘
     * 
     * func
     * @par é‚»æ¥ç»“ç‚¹
     */
    void for_each(int cur, const std::function<void(int)>& func) {
        for(auto& n : matrix[cur]) {
            func(n);
        }
    }

    /**
     * åˆå§‹åŒ–
     * O(n)
     * @par root æ ¹èŠ‚ç‚¹
     */
    void init(int root = 1) {
        dfs1(root);
        dfs2(root, root);
    }

    /**
     * æ±‚è§£lca
     * O(log n)
     * @par x èŠ‚ç‚¹x
     * @par y èŠ‚ç‚¹y
     * @return è¿”å›èŠ‚ç‚¹xå’ŒèŠ‚ç‚¹yçš„LCAèŠ‚ç‚¹
     */
    int lca(int x, int y) {
        while(top[x] != top[y]) {
            if(depth[top[x]] > depth[top[y]]) {
                x = parent[top[x]];
            } else {
                y = parent[top[y]];
            }
        }
        return depth[x] < depth[y] ? x : y;
    }

    /**
     * æŸ¥è¯¢ä¸¤ç‚¹é—´çš„è·ç¦»
     * @par x èŠ‚ç‚¹x
     * @par y èŠ‚ç‚¹y
     * @return ä¸¤ç‚¹é—´çš„è·ç¦»
     */
    int distance(int x, int y) {
        return depth[x] + depth[y] - (depth[lca(x, y)] << 1);
    }

private:
    int n; // èŠ‚ç‚¹ä¸ªæ•°
    std::vector<std::vector<int>> matrix; // é‚»æ¥çŸ©é˜µ
    std::vector<int> size; // size[i] = jï¼šè¡¨ç¤ºièŠ‚ç‚¹çš„å­æ ‘å¤§å°ä¸ºj
    std::vector<int> depth; // depth[i] = jï¼šè¡¨ç¤ºièŠ‚ç‚¹çš„æ·±åº¦ä¸ºj
    std::vector<int> top; // top[i] = jï¼šè¡¨ç¤ºièŠ‚ç‚¹æ‰€åœ¨çš„é‡é“¾å¤´éƒ¨ä¸ºj
    std::vector<int> son; // son[i] = jï¼šè¡¨ç¤ºièŠ‚ç‚¹çš„é‡å„¿å­ä¸ºj
    std::vector<int> parent; // father[i] = jï¼šè¡¨ç¤ºièŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ä¸ºj

    /**
     * ç¬¬ä¸€æ¬¡dfs
     * @par cur å½“å‰èŠ‚ç‚¹
     */
    void dfs1(int cur) {
        size[cur] = 1;
        depth[cur] = depth[parent[cur]] + 1;
        for_each(cur, [&](int neighbor) {
            if(neighbor == parent[cur]) {
                return; // continue
            }

            parent[neighbor] = cur;
            dfs1(neighbor);
            // æ›´æ–°å½“å‰èŠ‚ç‚¹çš„å­æ ‘å¤§å°
            size[cur] += size[neighbor];
            // å¯»æ‰¾é‡å„¿å­
            if(size[neighbor] > size[son[cur]]) {
                son[cur] = neighbor;
            }
        });
    }

    /**
     * ç¬¬äºŒæ¬¡dfs
     * @par cur å½“å‰èŠ‚ç‚¹
     * @par up å½“å‰èŠ‚ç‚¹çš„é‡é“¾å¤´éƒ¨
     */
    void dfs2(int cur, int up) {
        top[cur] = up;
        if(son[cur]) {
            dfs2(son[cur], up);
        }
        for_each(cur, [&](int neighbor) {
            if(neighbor == parent[cur] || neighbor == son[cur]) {
                return; // continue
            }
            dfs2(neighbor, neighbor);
        });
    }
};
```



# æ•°è®º

## æ¨¡è¿ç®—

å–æ¨¡è¿ç®—ä¸ºæ±‚aé™¤ä»¥mçš„ä½™æ•°ï¼Œè®°ä¸º$a\mod\ m = a \% m$ã€‚

CåŠJavaå–æ¨¡è¿ç®—è§„åˆ™ï¼š$5 \% 3 = 2ï¼Œ(-5)\%(-3)= -2ï¼Œ5\%(-3) = 2ï¼Œ(-5)\% 3 = -2$

å…ˆæŒ‰æ­£æ•´æ•°å–ä½™ï¼Œç„¶ååŠ ä¸Šç¬¦å·ï¼Œç¬¦å·ä¸è¢«é™¤æ•°ä¿æŒä¸€è‡´ã€‚

æ€§è´¨ï¼š

1. $( a + b ) \mod m = ( (a \mod m) + (b \mod m) ) \mod m$å¦‚æœæ²¡æœ‰é™åˆ¶abæ­£è´Ÿï¼ŒCä»£ç ä¸­å·¦å³å¯èƒ½ç¬¦å·ç›¸åã€å¤§å°ç›¸å·®mã€‚

2. $( a - b ) \mod m = ( (a \mod m) - (b \mod m) ) \mod m$å¦‚æœæ²¡æœ‰é™åˆ¶abæ­£è´Ÿï¼ŒCä»£ç ä¸­å·¦å³å¯èƒ½ç¬¦å·ç›¸åã€å¤§å°ç›¸å·®mã€‚

3. $( a * b )\mod m = ( (a \mod m) * (b \mod m) ) \mod m$ã€‚

4. å¯¹äºé™¤æ³•æ˜¯é”™è¯¯çš„ã€‚

å¯¹äºä¹˜æ³•çš„å¤§æ•°å–æ¨¡ï¼Œç›´æ¥ç”¨a*bä¼šæº¢å‡ºï¼Œ $(a \mod m) * (b \mod m)$ä¹Ÿå¯èƒ½æº¢å‡ºã€‚æ­¤æ—¶éœ€è¦è¿™æ ·é¿å…ã€‚

$a * b$æ”¹æˆ$(a * 2 * 2 * 2 * 2 * 2) * (b\div2\div2\div2\div2\div2)$ã€‚å¦‚æœbæ˜¯å¥‡æ•°å˜æˆ$(a * 2) * (b\div 2 + 1) = (a * 2) * (b\div 2) + (a * 2)$

å¦‚æœmæ¯”aå¤§ï¼Œmulå‡½æ•°ä»ä¼šå‡ºé”™ã€‚

```c++
long long mul (long long a,long long b, long long m)
{
	a = a % m;
	b = b % m;
	long long res = 0;
	while(b > 0)
	{
		if(b & 1)//åˆ¤æ–­å¥‡å¶
			res = (res + a) % m;
		a = (a + a) % m;
		b >>=1;
	}
	return res;
}
int main()
{
	long long a;
	long long b;
	long long m;
	cout<<mul(a, b, m);
}
```

## å¿«é€Ÿå¹‚

$a^{11} = a^8+a^2+a^1; 11 ={011_2}=2^3+2^1+2^0 = 8+ 2+ 1 $

```c++
long long fastpow(long long a,long long b,long long mod)
{
    long long ans = 1;
    a = a % mod;
    while(b)
    {
        if(b & 1)
        	ans = ans * a % mod;//è¦ä¹˜
   		a = a * a % mod;//é€’æ¨2 4 8 16
    	b = b >> 1;//è¿›ä½
    }
    return ans;
}
```

## çŸ©é˜µ

çŸ©é˜µä¹˜æ³•

$A = m * n , B = n * u,C =AB= m*u$

```c++
for(int i = 1;i <= m;i++)
    for(int j = 1;j <= u;j++)
        for(int k = 1;k <= n;k++)
            c[i][j] +=a[i][k] * b[k][j];
```

çŸ©é˜µå¿«é€Ÿå¹‚

```c++
struct matrix
{
	int m[N][N];
};
matrix operator * (const matrix &a,const matrix & b)//é‡è½½*ä¸ºçŸ©é˜µç›¸ä¹˜
{
	matrix c;
	memset(c.m, 0, sizeof(c.m));
	for(int i = 0;i < N;i++)
		for(int j = 0;j < N;j++)
			for(int k = 0;k < N;k++)
				//c.m[i][j] += a.m[i][k] * b.m[k][j];
				c.m[i][j] = (c.m[i][j] + a.m[i][k] * b.m[k][j]) % mod;
	return c;
}
matrix pow_matrix(matrix a,int n)
{
	matrix ans;
	memset(ans.m, 0, sizeof(ans.m));//å•ä½çŸ©é˜µ
	for(int i = 0;i < N;i++)
	{
		ans.m[i][i] = 1;
	}
	while(n)
	{
		if(n&1)
			ans = ans * a;
		a = a * a;
		n >>= 1;
	}
	return ans;
}
```

## GCDä¸LCM

### GCD

$gcd(a,b) = gcd(|a|,|b|)$ã€‚å› ä¸º$-a$çš„å› å­ä¸$a$ç›¸åŒ,æ‰€ä»¥$gcd(a,b) = gcd(|a|,|b|)$

äº’ç´ :$gcd(a,b) = 1$;

GCDæ€§è´¨

1.$gcd(a,b) = gcd(a, a+b) = gcd(a,k*a+b)$

2.$gcd(ka,kb) = k * gcd(a,b)$

3.å®šä¹‰å¤šä¸ªæ•´æ•°çš„GCDï¼š$gcd(a,b,c) = gcd[gcd(a,b),c]$

4.è‹¥$gcd(a,b) = d$ï¼Œåˆ™$gcd(a/d,b/d) = 1$,å³$a/d$ä¸$b/d$äº’ç´ 

5.$gcd(a+cd,b) = gcd(a,b)$

#### æ¬§å‡ é‡Œå¾—ç®—æ³•

$gcd(a,b) = gcd(b,a \% b)$

```c++
int mygcd(int a, int b)
{
	return b ? gcd(b,a%b): a;
}
```

æ­¤ç®—æ³•è¦åšå–æ¨¡ï¼Œé«˜ç²¾åº¦é™¤æ³•å–æ¨¡è€—æ—¶ï¼Œå¯ä»¥é‡‡ç”¨ä»¥ä¸‹ç®—æ³•ã€‚

#### æ›´ç›¸å‡æŸæœ¯

$gcd(a,b) = gcd(b,b -a)=gcd(a,a-b)$

```c++
int mygcd(int a, int b)
{
    while(a != b)
    {
        if(a > n)
            a = a - b;
        else
            b = b - a;
    }
    return a;
}
```

#### Steinç®—æ³•

(1)aå’Œbéƒ½æ˜¯å¶æ•°ã€‚$gcd(a,b) = 2gcd(a/2,b/2)$

(2)aå¥‡bå¶æ•°ï¼ˆaå¶bå¥‡ï¼‰ã€‚è‹¥kä¸yäº’ä¸ºè´¨æ•°ï¼Œæœ‰$gcd(kx,y) = gcd(x,b)$ã€‚å½“k  = 2ï¼Œbä¸ºå¥‡æ•°æ—¶ï¼Œæœ‰$gcd(a,b) = gcd(a/2,b)$ã€‚

(3)aå’Œbéƒ½æ˜¯å¥‡æ•°ã€‚$gcd(a,b) = gcd((a+b)/2,(a-b)/2)$

```c++
int stein(int a,int b)
{
	if(a < b)
	{
		a^=b;
		b^=a;
		a^=b;
	}
	if(b==0)
		return a;
	if( (!(a&1)) && (!(b&1)) )
		return stein(a>>1,b>>1) << 1;
	else if( (a&1) && (!(b&1)) )
		return stein(a,b>>1);
	else if(!(a&1)) && (b&1) )
		return stein(a>>1,b);
	else
		return stein(a-b,b);
}
```

### LCM

$gcd(a,b)lcm(a,b)=ab$,å³$lcm(a,b) = ab/gcd(a,b) = a/gcd(a,b)b$

å…ˆé™¤åä¹˜

```c++
int lcm(int a,int b)
{
	return a / gcd(a,b) * b;
}
```



#### è£´èœ€å®šç†

å¦‚æœaä¸bå‡ä¸ºæ•´æ•°ï¼Œåˆ™æœ‰æ•´æ•°xå’Œyä½¿$ax+by=gcd(a,b)$ã€‚

##### æ´›è°·P4549 

```c++
#include <iostream>
using namespace std;
int a[100003];
long long gcd(int a,int b)
{
    return b ? gcd(b,a%b):a;
}
int main ()
{
    int n;
    int i;
    cin>>n;
    for(i = 0;i < n;i++)
    {
        cin>>a[i];
    }
    long long sum = 0;
    sum = gcd(abs(a[0]),abs(a[1]));
    for(i = 1;i < n;i++)
    {
        sum = gcd(abs(a[i]),sum);
    }
    cout<<sum;
}
```



## çº¿æ€§ä¸¢ç•ªå›¾æ–¹ç¨‹

æ–¹ç¨‹$ax + by = c$æˆä¸ºäºŒå…ƒæ€§ä¸¢ç•ªå›¾æ–¹ç¨‹ï¼Œå¦‚æœç›´çº¿ä¸Šæœ‰æ•´æ•°åæ ‡ç‚¹ï¼Œå°±æœ‰è§£ï¼Œæ²¡æœ‰åˆ™æ— è§£ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªè§£å°±æœ‰æ— æ•°ä¸ªè§£ã€‚

è®¾aï¼Œbä¸ºæ•´æ•°ä¸”$gcd(aï¼Œb) = d$ã€‚å¦‚æœdä¸èƒ½æ•´é™¤cï¼Œé‚£ä¹ˆæ–¹ç¨‹$ax + by = c$æ²¡æœ‰æ•´æ•°ï¼Œå¦åˆ™å­˜åœ¨æ— ç©·å¤šä¸ªè§£ã€‚å¦‚æœï¼ˆ${x_0}$ï¼Œ${y_0}$ï¼‰æ˜¯æ–¹ç¨‹çš„ä¸€ä¸ªç‰¹è§£ï¼Œé‚£ä¹ˆæ‰€æœ‰è§£å¯ä»¥è¡¨ç¤ºä¸º$x = {x_0}+\frac{b}{d}*n$ï¼Œ$y = {y_0}-\frac{a}{d}*n$,nä¸ºä»»æ„æ•´æ•°ã€‚

### æ‰©å±•æ¬§å‡ é‡Œå¾—æ±‚ç‰¹è§£

è¿­ä»£æ—¶$gcd(a,0) = a$   $ax + 0y = gcd(a,0) = a$æ­¤æ—¶æœ‰ç‰¹è§£$x = 1,y = 0$ã€‚

$gcd(a,b) = gcd(b,a\%b)$ã€‚$ax + by = gcd(a,b)$ã€‚

$ax + by = bx'+a\%by' = bx'+[a-b(a/b)]y' = bx' + ay' - b(a/b)y' = ay'+b[x'-(a/b)y']$

$ \begin{cases}x = y' \\y = x'-(\frac{a}{b})y\end{cases} $

ä½¿ç”¨æ¬§å‡ é‡Œå¾—æ±‚$ax + by = gcd(a,b)$çš„ä¸€ä¸ªç‰¹è§£ä¹‹åï¼Œå¯ä»¥æ±‚$ax + by = c$çš„ä¸€ä¸ªé€šè§£ã€‚

è®°$d = gcd(a,b)$ï¼Œæ­¤æ—¶$gcd(a,b)$èƒ½æ•´é™¤$c$ã€‚æ¬§å‡ é‡Œå¾—æ±‚å‡ºçš„ç‰¹è§£ä¸º$(x_0,y_0)$ã€‚tyjk./

åœ¨$ax_0+by_0 = d$ä¸¤è¾¹åŒæ—¶ä¹˜ä»¥$c / d$ï¼Œå¾— $ax_0c/d+by_0c/d = c$ï¼Œæ­¤æ—¶å¯ä»¥å¾—åˆ°$ax + by = c$çš„ä¸€ä¸ªè§£ä¸º$(x_0',y_0')$ã€‚

å³$x_0=x_0c/d ï¼Œy_0 = y_0c/d$ã€‚æ•…é€šè§£ä¸º$x = x_0'+(b/d)nï¼Œy = y_0'-(a/d)n$ã€‚

æ³¨ï¼šæ¬§å‡ é‡Œå¾—æ±‚å‡ºçš„æ˜¯$ax + by = gcd(a,b)$çš„ç‰¹è§£ã€‚

```c++
long long extend_gcd(long long a, long long b, long long &x,long long &y)//è¿”å›gcd(a,b),æ”¹å˜ç‰¹è§£xï¼Œy
{
	if(b==0)
	{
		x = 1;
		y = 0;
		return 0;
	}
	long long d = extend_gcd(b, a%b, y,x);
	y = y - a / b * x;
	return d;
}
```

æ±‚æœ€å°è§£ã€‚

å·²çŸ¥é€šè§£ä¸º$x = x_0 + (b/d)n$è¦ä½¿$x$æœ€å°ï¼Œåˆ™éœ€è¦$x_0$ä¸æ–­çš„å‡$b/d$ã€‚é‚£ä¹ˆæ­¤è¿‡ç¨‹ç›¸å½“äºå–æ¨¡

å…¬å¼ä¸º$((x_0 \% (b/d)+b/d)\%(b/d))$ å¤šåŠ ä¸€æ¬¡å†å»æ¨¡é˜²æ­¢è´Ÿæ•°ã€‚

##### æ´›è°·P1516

```c++
#include <iostream>

using namespace std;
long long exgcd(long long a,long long b,long long &x,long long &y)
{
    if(b == 0)
    {
        x = 1;
        y = 0;
        return a;
    }
    long long d = exgcd(b,a%b,y,x);
    y -= a/b*x;
    return d;
}
int main () {
    long long x, y, m, n, l;
    cin >> x >> y >> m >> n>>l;
    long long  c = x - y;
    long long a = n - m;
    if (a < 0) {
        a = -a;
        c = -c;
    }
    long long d = exgcd(a, l, x, y);
    if (c % d != 0)
        cout << "Impossible";
    else
        cout << ((x*c/d ) % (l / d) + (l / d)) % (l / d);
}
```

### å¤šå…ƒçº¿æ€§ä¸¢ç•ªå›¾æ–¹ç¨‹

å¦‚æœ$a_1,a_2,a_3,â€¦â€¦,a_n$æ˜¯éé›¶æ•´æ•°ï¼Œé‚£ä¹ˆæ–¹ç¨‹$a_1x_1+a_2x_2+â€¦â€¦+a_nx_n = c$æœ‰æ•´æ•°è§£ï¼Œå½“ä¸”ä»…å½“$d = gcd(a_1,a_2,â€¦â€¦,a_n)$æ•´é™¤$c$ï¼Œå¦‚æœæ–¹ç¨‹å­˜åœ¨ä¸€ä¸ªè§£ï¼Œåˆ™æ–¹ç¨‹æœ‰æ— æ•°å¤šä¸ªè§£ã€‚

## åŒä½™ 

åŒä½™å®šä¹‰ï¼šè®¾mæ˜¯æ­£æ•´æ•°ï¼Œè‹¥aå’Œbæ˜¯æ•´æ•°ï¼Œä¸”$m \lvert (a - b)$ï¼Œåˆ™ç§°a å’Œ b æ¨¡åŒä½™ï¼Œä¹Ÿå°±æ˜¯è¯´ aé™¤ä»¥må¾—åˆ°çš„ä½™æ•°ï¼Œå’Œbé™¤ä»¥mçš„ä½™æ•°ç›¸åŒï¼›æˆ–è€…è¯´a - b é™¤ä»¥m ï¼Œä½™æ•°ä¸º0ï¼Œå› ä¸ºaå’Œbä¸­é—´éš”äº†nä¸ªmã€‚

åŒä½™è®°ä½œ$a \equiv b(\mod m)$,mä¸ºåŒä½™çš„æ¨¡ã€‚

ä¾‹å¦‚$7 \lvert(18 - 4)$ï¼Œæ‰€ä»¥ $18 \equiv 4(\mod 7)$ã€‚

åŒä½™çš„æ€§è´¨

è‹¥aå’Œbä¸ºæ•´æ•°ï¼Œmä¸ºæ­£æ•´æ•°ï¼Œåˆ™$a \equiv b(\mod m)$å½“ä¸”ä»…å½“$a \mod m = b \mod m$ã€‚

åŒä½™è½¬åŒ–ä¸ºç­‰å¼ã€‚è‹¥a å’Œ b æ˜¯æ•´æ•°ï¼Œ åˆ™ $a \equiv b(\mod m)$ å½“ä¸”ä»…å½“ å­˜åœ¨æ•´æ•°kï¼Œä½¿ $a = b  + km$ã€‚

è®¾mæ˜¯æ­£æ•´æ•°ï¼Œæ¨¡måŒä½™çš„æ€§è´¨

ï¼ˆ1ï¼‰è‡ªåæ€§ï¼š$a \equiv a(\mod m)$

ï¼ˆ2ï¼‰å¯¹ç§°æ€§ï¼š$a \equiv b(\mod m)åˆ™b \equiv a(\mod m)$

ï¼ˆ3ï¼‰ä¼ é€’æ€§ï¼š$a \equiv b(\mod m)ï¼Œb \equiv c(\mod m)ï¼Œåˆ™a \equiv c(\mod m)$

### ä¸€å…ƒçº¿æ€§åŒä½™æ–¹ç¨‹

è®¾xæ˜¯æœªçŸ¥æ•°ï¼Œç»™å®š$aã€bã€m$ï¼Œæ±‚æ•´æ•°xï¼Œæ»¡è¶³$ax\equiv b(\mod m) $ã€‚åˆ™æœ‰$ax + my = b$ï¼Œè¿™æ˜¯äºŒå…ƒçº¿æ€§ä¸¢ç•ªå›¾æ–¹ç¨‹ã€‚

æ‰€ä»¥ï¼Œæ±‚è§£ä¸€å…ƒçº¿æ€§åŒä½™æ–¹ç¨‹ç­‰ä»·äºæ±‚è§£äºŒå…ƒçº¿æ€§ä¸¢ç•ªå›¾æ–¹ç¨‹ã€‚

### é€†

ç»™å®šæ•´æ•°aï¼Œä¸”æ»¡è¶³$gcd(a,m) = 1$ï¼Œç§°$ax \equiv 1(\mod m)$çš„ä¸€ä¸ªè§£ä¸ºaæ¨¡mçš„é€†å…ƒï¼Œè®°$a^{-1}$ã€‚

ä¾‹å¦‚ï¼Œ$8x \equiv 1(\mod 31)$,æœ‰ä¸€ä¸ªè§£æ˜¯$x = 4$ï¼Œ4æ˜¯8æ¨¡31çš„é€†ã€‚æ‰€æœ‰è§£ï¼Œå¦‚36ã€66ç­‰ä¹Ÿæ˜¯8æ¨¡31çš„é€†ã€‚

ä¹Ÿå¯ä»¥åŒ–ä¸º$8x + 31y = 1$,$x = 4$æ˜¯8æ¨¡31çš„é€†ã€‚å¯ä»¥çœ‹å‡ºmæœ€å¥½æ˜¯å¤§äºaçš„ç´ æ•°ï¼Œæ‰èƒ½ä¿è¯$gcd(a,m) = 1$ã€‚

#### æ±‚é€†

##### æ‰©å±•æ¬§å‡ é‡Œå¾—æ±‚é€†

æ´›è°·P1082

```c++
//
// Created by ZA on 2024/8/29.
//
#include <iostream>
using namespace std;
long long excd(long long a,long long b,long long &x,long long &y)
{
    if(b == 0)
    {
         x = 1;
         y = 0;
        return a;
    }
    long long d = excd(b, a%b,y,x);
    y -= a/b*x;
    return d;
}
int main ()
{
    long long a,b;
    long long y,x;
    cin>>a>>b;
    long long d = excd(a,b,x,y);

    cout<<(x % b + b) %b;
}
```

##### è´¹é©¬å°å®šç†

è®¾næ˜¯ç´ æ•°ï¼Œaæ˜¯æ­£æ•´æ•°ä¸”ä¸näº’ç´ ï¼Œæœ‰$a^{n-1} \equiv 1(\mod n)$ã€‚

$a*a^{n-2} \equiv1(\mod n)$ï¼Œé‚£ä¹ˆ$a^{n-2} \mod n$å°±æ˜¯aæ¨¡nçš„é€†å…ƒã€‚

```c++
long long mod_inverse(long long a,long long mod)
{
	return fast_pow(a,mod - 2,mod);
}
```



# ç»„åˆæ•°å­¦

### å¡ç‰¹å…°æ•°



C0 = 1,         
C1 = 1,         C2 = 2,          C3 = 5,          C4 = 14,          C5 = 42,
C6 = 132,       C7 = 429,        C8 = 1430,       C9 = 4862,        C10 = 16796,
C11 = 58786,    C12 = 208012,    C13 = 742900,    C14 = 2674440,    C15 = 9694845,
C16 = 35357670, C17 = 129644790, C18 = 477638700, C19 = 1767263190, C20 = 6564120420, ...

### LCD

åŸƒå¼ç­›

```c++
for(int i = 2; i <= n;i++)
{
	a[i] = 1;
}
for(int i = 2;i <= n;i++)
{
	for(int j = 2;j * i <= n;j++)
	{
		a[i*j] = 0;
	}
	
}
int ans = 0;
for(int i = 2;i <= n;i++)
{
	if(a[i])
	{
		b[ans] = i;
		ans++;
	}
}
```

æ¬§æ‹‰ç­›

```
for(i)
```



### å¼‚æˆ–

Y=Aâ€™â‹…B+Aâ‹…Bâ€™

æ’ç­‰å¾‹ï¼šX âŠ• 0 = X

å½’ é›¶ å¾‹ ï¼š X âŠ• X = 0 

# STL

### å­—ç¬¦ä¸²String

 1.substr (size_t pos  = 0, size_t len = pos)

substrå‡½æ•°ç”¨äºä»å­—ç¬¦ä¸²ä¸­æå–å­—ç¬¦ä¸²ã€‚posæ˜¯å­—ç¬¦ä¸²å¼€å§‹çš„ä½ç½®ï¼Œé»˜è®¤ä¸º0ï¼Œlenæ˜¯æå–å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œå¦‚æœä¸æä¾›lenï¼Œnposå°†è¢«è®¤è¯é»˜è®¤å€¼ï¼Œæ„å‘³ç€å­—ç¬¦ä¸²å°†ä»poså¼€å§‹ä¸€ç›´å»¶ä¼¸è‡³æœ«å°¾ã€‚

```c++
std::string s = "Hello,World!";//ç´¢å¼•ä»0å¼€å§‹
//æå–æ•´ä¸ªå­—ç¬¦ä¸²
std::string sub = s.substr();
//sub = "Hello,World!"
//ä»å­—ç¬¦ä¸²ä¸­é—´æˆªå–
std::string sub = s.substr(6);//ä»ç´¢å¼•6å¼€å§‹
//sub = "world!"
//æå–ç‰¹å®šé•¿åº¦çš„å­å­—ç¬¦ä¸²
std::string sub = s.substr(6,2);//ä»ç´¢å¼•6å¼€å§‹æå–2ä¸ªå­—ç¬¦
//sub = "wo";
```



# å…¶ä»–

### å–ä¸€è¡Œå­—ç¬¦ä¸²

cin.getline(a,101);

ä½¿ç”¨æ‰«æä¸€è¡Œï¼Œæ‰«æä¸€è¡Œä¹‹å‰å…‰æ ‡åº”åœ¨å½“å‰è¡Œé¦–ï¼Œå¦‚æœæ²¡æœ‰åŠæ—¶æ¢è¡Œï¼Œé‚£ä¹ˆç¬¬ä¸€æ¬¡è¯»å–çš„å¯èƒ½ä¸ºç©ºï¼Œæ‰€ä»¥æœ‰æ—¶å€™åº”å½“åŠ å…¥getcharï¼ˆ)ä½¿å¾—å…‰æ ‡æ¢è¡Œã€‚

### å…³é—­è¾“å…¥è¾“å‡ºæµåŒæ­¥ï¼Œè§£ç»‘è¾“å…¥è¾“å‡ºæµ

```c++
ios::sync_with_stdio(0);
cin.tie(0);
cout.tie(0);
```

æ³¨æ„äº‹é¡¹ï¼š

1.ä¸é€‚ç”¨äºæ··åˆè¾“å…¥è¾“å‡ºï¼šå¦‚æœä½ çš„ç¨‹åºåœ¨è¾“å…¥è¾“å‡ºä¸­åŒæ—¶ä½¿ç”¨äº†C++çš„è¾“å…¥è¾“å‡ºæµå’ŒCæ ‡å‡†åº“çš„è¾“å…¥è¾“å‡ºå‡½æ•°ï¼ˆå¦‚scanfå’Œprintfï¼‰ï¼Œåˆ™ä¸åº”è¯¥ä½¿ç”¨è¿™æ®µä»£ç ã€‚å› ä¸ºè¿™ä¼šå¯¼è‡´è¾“å…¥è¾“å‡ºä¹‹é—´çš„ä¸åŒæ­¥ã€‚

2.ä¸èƒ½æ··ç”¨è¾“å…¥è¾“å‡ºå‡½æ•°ï¼šåœ¨ä½¿ç”¨äº†è¿™æ®µä»£ç åï¼Œåº”é¿å…ä½¿ç”¨Cæ ‡å‡†åº“çš„è¾“å…¥è¾“å‡ºå‡½æ•°ï¼ˆå¦‚printfå’Œscanfï¼‰ï¼Œå› ä¸ºè¿™äº›å‡½æ•°ä¸è¾“å…¥è¾“å‡ºæµçš„åŒæ­¥å·²è¢«å…³é—­ã€‚ç®€å•æ¥è¯´ï¼Œå…³é—­äº†åŒæ­¥æµï¼Œå°±ä¸èƒ½ç”¨scanfå’Œprintfã€‚

3.å…³é—­äº†åŒæ­¥æµï¼Œä¸èƒ½ç”¨getchar()å‡½æ•°ã€‚

4.ä¸å½±å“ç¨‹åºæ­£ç¡®æ€§ï¼šå…³é—­è¾“å…¥è¾“å‡ºæµçš„åŒæ­¥ä¸ä¼šå½±å“ç¨‹åºçš„æ­£ç¡®æ€§ï¼Œå®ƒåªæ˜¯ä¸ºäº†æé«˜ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ã€‚å› æ­¤ï¼Œåœ¨ä¸€äº›å¯¹è¾“å…¥è¾“å‡ºæ€§èƒ½è¦æ±‚è¾ƒé«˜çš„åœºæ™¯ä¸‹ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨è¿™æ®µä»£ç ã€‚

5.å…³é—­äº†åŒæ­¥æµï¼ˆä¹Ÿå°±æ˜¯ä½¿ç”¨è¿™æ®µä»£ç ï¼‰ï¼Œä¸èƒ½å†ç”¨cout<<endlã€‚è€Œåº”è¯¥æ”¹ç”¨cout<<'\n'ã€‚

å› ä¸ºé€šå¸¸æƒ…å†µä¸‹ï¼Œcout<<endlä¼šè¾“å‡ºä¸€ä¸ªæ¢è¡Œç¬¦å¹¶åˆ·æ–°è¾“å‡ºç¼“å†²åŒºï¼Œç¡®ä¿å†…å®¹ç«‹å³æ˜¾ç¤ºã€‚ä½†æ˜¯ï¼Œå½“ä½¿ç”¨äº†ä¸Šè¿°ä»£ç æ—¶ï¼Œcout<<endlä¸å†å…·æœ‰è‡ªåŠ¨åˆ·æ–°ç¼“å†²åŒºçš„åŠŸèƒ½ã€‚
6.è¿™ä¸‰è¡Œä»£ç å¿…é¡»ä¸€èµ·ç”¨ï¼Œä¸èƒ½åªç”¨ç¬¬ä¸€è¡Œä»£ç ï¼Œä½¿ç”¨è¿™ä¸‰è¡Œä»£ç æ—¶ï¼Œå¾—ç”¨C++çš„å¤´æ–‡ä»¶ã€‚ç®—æ³•ç«èµ›ä¸ºäº†æ–¹ä¾¿ï¼Œä¸€èˆ¬ä½¿ç”¨ä¸‡èƒ½å¤´æ–‡ä»¶bits/stdc++.hã€‚
